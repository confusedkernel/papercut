{{- $title := .Get "title" | default "Untitled" -}}
{{- $description := .Get "description" | default "" -}}
{{- $url := .Get "url" | default "#" -}}
{{- $icon := .Get "icon" | default "" -}}
{{- $target := .Get "target" | default "" -}}
{{- if eq $target "" -}}
  {{- if or (hasPrefix $url "http://") (hasPrefix $url "https://") -}}
    {{- $target = "_blank" -}}
  {{- else -}}
    {{- $target = "_self" -}}
  {{- end -}}
{{- end -}}
{{- $rel := .Get "rel" | default "" -}}
{{- if and (eq $target "_blank") (eq $rel "") -}}
  {{- $rel = "noopener noreferrer" -}}
{{- end -}}

{{- $displayHost := $url -}}
{{- if or (hasPrefix $url "http://") (hasPrefix $url "https://") -}}
  {{- $displayHost = replaceRE "^https?://([^/]+).*$" "$1" $url -}}
{{- end -}}

<a
  class="sc-link-card"
  href="{{ $url }}"
  target="{{ $target }}"
  {{- with $rel }} rel="{{ . }}"{{ end -}}
>
  <span class="sc-link-card__media{{ if $icon }} sc-link-card__media--image{{ end }}" aria-hidden="true">
    {{- if $icon -}}
      <img src="{{ $icon }}" alt="" loading="lazy" />
    {{- else -}}
      {{ partial "shortcode-icon.html" (dict "name" "link" "class" "sc-link-card__icon" "size" "1.15rem") }}
    {{- end -}}
  </span>
  <span class="sc-link-card__body">
    <span class="sc-link-card__title">{{ $title }}</span>
    {{- with $description -}}
      <span class="sc-link-card__description">{{ . }}</span>
    {{- end -}}
    <span class="sc-link-card__meta">{{ $displayHost }}</span>
  </span>
</a>
